(self.webpackChunkatomixwap=self.webpackChunkatomixwap||[]).push([[72],{50:(t,e,r)=>{t.exports=r(3992)},3992:t=>{t.exports=class{constructor(t,e){this.channelName=t,this.onMessage=e,this._installListener(),this._requests=new Map,this._nextId=0,this._defaultTimeout=4e3}_installListener(){const t=this;this._listener=function(e){if(!e.data||"string"!=typeof e.data)return;let r;try{if(r=JSON.parse(e.data),!r.channel||r.channel!==t.channelName)return;if("object"!=typeof r.message)return}catch(t){return}if(void 0!==r.replyId){if("number"!=typeof r.replyId||r.replyId%1!=0)return;const e=t._requests.get(r.replyId);e&&(clearTimeout(e.timeout),t._requests.delete(r.replyId),e.resolve(r.message))}else{if("number"!=typeof r.id||r.id%1!=0||!t.onMessage)return;const s=t.channelName,n=r.id,i=e.origin,o=function(t){const r={channel:s,replyId:n,message:t};e.source.postMessage(JSON.stringify(r),i)};t.onMessage(r.message,e.origin,e.source,o,t)}},window.addEventListener("message",this._listener)}sendMessage(t,e,r,s){const n={channel:this.channelName,id:this.getNextId(),message:e};if(s&&s.waitForReply){const e=this;return new Promise((function(i,o){const a=setTimeout((function(){e._requests.get(n.id)&&(e._requests.delete(n.id),o(new Error("Timeout expired for the message response")))}),s&&s.timeout?s.timeout:e._defaultTimeout);e._requests.set(n.id,{timeout:a,resolve:i}),t.postMessage(JSON.stringify(n),r)}))}t.postMessage(JSON.stringify(n),r)}close(){window.removeEventListener("message",this._listener),this._listener=null,delete this._requests}getNextId(){return this._nextId+=1,this._nextId}}},1072:(t,e,r)=>{t.exports=r(7151)},7151:(t,e,r)=>{var s=r(8764).Buffer;const{openPopup:n}=r(4259),{sleep:i,prepareTxn:o}=r(2780),a=r(4587),u=r(6035);let c=null;t.exports=class{constructor(t){c||(c=new u),this.bridge=c,this.timeout=t&&t.timeout?t.timeout:16e5,this.url=t&&t.bridgeUrl?t.bridgeUrl:"https://wallet.myalgo.com/bridge",this.url.endsWith("/")&&(this.url=this.url.slice(0,-1)),this.currentConnectPopup=null,this.currentSigntxPopup=null,this.currentSignLogicSigPopup=null,this.currentTealSignPopup=null,this.options={waitForReply:!0,timeout:this.timeout},this.disableLedgerNano=!(!t||!t.disableLedgerNano)&&t.disableLedgerNano}async connect(t={shouldSelectOneAccount:!1,openManager:!1}){this.currentConnectPopup&&(this.currentConnectPopup.closed?this.currentConnectPopup=null:this.focusWindow(this.currentConnectPopup));try{this.currentConnectPopup=n(this.url+"/connect.html"),await this.waitForWindowToLoad(this.currentConnectPopup);const e=await this.bridge.sendMessage(this.currentConnectPopup,{method:"unlock",params:Object.assign(t,{disableLedgerNano:this.disableLedgerNano})},this.url,this.options);if(this.closeWindow(this.currentConnectPopup),this.currentConnectPopup=null,"error"===e.status)throw new Error(e.message);return e.data.accounts}catch(t){throw this.closeWindow(this.currentConnectPopup),this.currentConnectPopup=null,t}}async signTransaction(t,e){let r;this.currentSigntxPopup&&(this.currentSigntxPopup.closed?this.currentSigntxPopup=null:this.focusWindow(this.currentSigntxPopup)),r=Array.isArray(t)?Array.from(t).map((t=>o(t))):o(t);try{this.currentSigntxPopup=n(this.url+"/signtx.html"),await this.waitForWindowToLoad(this.currentSigntxPopup);const t=await this.bridge.sendMessage(this.currentSigntxPopup,{method:"transaction",params:{txn:r,settings:{disableLedgerNano:this.disableLedgerNano},options:e}},this.url,this.options);if(this.closeWindow(this.currentSigntxPopup),this.currentSigntxPopup=null,"error"===t.status)throw new Error(t.message);if(Array.isArray(t.data)){const e=[];for(const r of t.data)r.blob=new Uint8Array(s.from(r.blob,"hex")),e.push(r);return e}return t.data.blob=new Uint8Array(s.from(t.data.blob,"hex")),t.data}catch(t){throw this.closeWindow(this.currentSigntxPopup),this.currentSigntxPopup=null,t}}async signLogicSig(t,e){this.currentSignLogicSigPopup&&(this.currentSignLogicSigPopup.closed?this.currentSignLogicSigPopup=null:this.focusWindow(this.currentSignLogicSigPopup));try{this.currentSignLogicSigPopup=n(this.url+"/logicsigtx.html"),await this.waitForWindowToLoad(this.currentSignLogicSigPopup);let r=t;t.constructor===Uint8Array&&(r=s.from(t).toString("base64"));const i=await this.bridge.sendMessage(this.currentSignLogicSigPopup,{method:"logicsig",params:{logic:r,address:e}},this.url,this.options);if(this.closeWindow(this.currentSignLogicSigPopup),this.currentSignLogicSigPopup=null,"error"===i.status)throw new Error(i.message);return new Uint8Array(s.from(i.data.signedTeal,"base64"))}catch(t){throw this.closeWindow(this.currentSignLogicSigPopup),this.currentSignLogicSigPopup=null,t}}async tealSign(t,e,r){this.currentTealSignPopup&&(this.currentTealSignPopup.closed?this.currentTealSignPopup=null:this.focusWindow(this.currentTealSignPopup));try{this.currentTealSignPopup=n(this.url+"/tealsign.html"),await this.waitForWindowToLoad(this.currentTealSignPopup);let i=t;t.constructor===Uint8Array&&(i=s.from(t).toString("base64"));const o=await this.bridge.sendMessage(this.currentTealSignPopup,{method:"tealsign",params:{data:i,contractAddress:e,address:r}},this.url,this.options);if(this.closeWindow(this.currentTealSignPopup),this.currentTealSignPopup=null,"error"===o.status)throw new Error(o.message);return new Uint8Array(s.from(o.data.signature,"base64"))}catch(t){throw this.closeWindow(this.currentTealSignPopup),this.currentTealSignPopup=null,t}}async waitForWindowToLoad(t,e=30){for(let r=0;r<e&&(await i(300),t);r++)try{if("success"==(await c.sendMessage(t,{method:"status"},this.url)).status)return}catch(t){}throw new Error(a.WINDOW_NOT_LOADED)}closeWindow(t){t&&!t.closed&&t.close&&t.close()}focusWindow(t){throw t&&t.focus?(t.focus(),new Error(a.WINDOW_IS_OPENED)):new Error(a.INVALID_WINDOW)}}},6035:(t,e,r)=>{const s=r(50);t.exports=class{constructor(t){const e=this;this.options={waitForReply:!0,timeout:250},this.listenerCallback=t,this.bridge=new s("wallet-bridge-communication-channel",(function(t,r,s,n){e.listenerCallback&&e.listenerCallback(t,s)}))}sendMessage(t,e,r,s){return this.bridge.sendMessage(t,e,r,s||this.options)}setNewListener(t){this.listenerCallback=t}close(){this.bridge.close()}}},4259:(t,e,r)=>{const{WINDOW_NOT_OPENED:s}=r(4587),n={width:400,height:600};t.exports={openPopup:function(t,e=n){let{name:r="",width:i,height:o,top:a=0,left:u=0}=e;i&&(window.outerWidth?u=Math.round((window.outerWidth-i)/2)+window.screenX:window.screen.width&&(u=Math.round((window.screen.width-i)/2))),o&&(window.outerHeight?a=Math.round((window.outerHeight-o)/2)+window.screenY:window.screen.height&&(a=Math.round((window.screen.height-o)/2))),i&&o&&(e={top:a,left:u,width:i,height:o,status:1,toolbar:0,menubar:0,resizable:1,scrollbars:1});const c=Object.keys(e).map((t=>{const r=e[t];if(null!=r&&"function"==typeof r.toString)return`${t}=${r.toString()}`})).filter(Boolean).join(",");let p;try{p=window.open(t,r,c)}catch(t){throw new Error(`${s} - ${t.stack||t.message}`)}if(!p||window.closed)throw new Error(`${s} - blocked`);return p}}},4587:t=>{t.exports={WINDOW_NOT_LOADED:"Window not loaded",WINDOW_IS_OPENED:"Windows is opened",WINDOW_NOT_OPENED:"Can not open popup window",INVALID_WINDOW:"Invalid window"}},2780:(t,e,r)=>{var s=r(8764).Buffer;t.exports={sleep:function(t=200){return new Promise((e=>setTimeout(e,t)))},prepareTxn:function(t){if(t.constructor===Uint8Array)return s.from(t).toString("base64");if("string"==typeof t)return t;const e=Object.assign({},t);if(e.note&&e.note.constructor===Uint8Array&&(e.note=s.from(e.note).toString("base64")),e.assetMetadataHash&&e.assetMetadataHash.constructor===Uint8Array&&(e.assetMetadataHash=s.from(e.assetMetadataHash).toString("base64")),e.group&&e.group.constructor===Uint8Array&&(e.group=s.from(e.group).toString("base64")),"appl"===e.type&&e.appApprovalProgram&&e.appApprovalProgram.constructor===Uint8Array&&(e.appApprovalProgram=s.from(e.appApprovalProgram).toString("base64")),"appl"===e.type&&e.appClearProgram&&e.appClearProgram.constructor===Uint8Array&&(e.appClearProgram=s.from(e.appClearProgram).toString("base64")),"appl"===e.type&&e.appArgs&&e.appArgs.length>0)for(let t=0;t<e.appArgs.length;t++)e.appArgs[t].constructor===Uint8Array&&(e.appArgs[t]=s.from(e.appArgs[t]).toString("base64"));return e}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFFUixNQUFNRSxFQUFNUCxPQUFPQyxPQUFPLENBQUMsRUFBR0ksR0FpQjlCLEdBZklFLEVBQUkwRCxNQUFRMUQsRUFBSTBELEtBQUsxSSxjQUFnQnlGLGFBQ3hDVCxFQUFJMEQsS0FBT2hELEVBQU9QLEtBQUtILEVBQUkwRCxNQUFNM0MsU0FBUyxXQUV2Q2YsRUFBSTJELG1CQUFxQjNELEVBQUkyRCxrQkFBa0IzSSxjQUFnQnlGLGFBQ2xFVCxFQUFJMkQsa0JBQW9CakQsRUFBT1AsS0FBS0gsRUFBSTJELG1CQUFtQjVDLFNBQVMsV0FFakVmLEVBQUk0RCxPQUFTNUQsRUFBSTRELE1BQU01SSxjQUFnQnlGLGFBQzFDVCxFQUFJNEQsTUFBUWxELEVBQU9QLEtBQUtILEVBQUk0RCxPQUFPN0MsU0FBUyxXQUU1QixTQUFiZixFQUFJNkQsTUFBbUI3RCxFQUFJOEQsb0JBQXNCOUQsRUFBSThELG1CQUFtQjlJLGNBQWdCeUYsYUFDM0ZULEVBQUk4RCxtQkFBcUJwRCxFQUFPUCxLQUFLSCxFQUFJOEQsb0JBQW9CL0MsU0FBUyxXQUV0RCxTQUFiZixFQUFJNkQsTUFBbUI3RCxFQUFJK0QsaUJBQW1CL0QsRUFBSStELGdCQUFnQi9JLGNBQWdCeUYsYUFDckZULEVBQUkrRCxnQkFBa0JyRCxFQUFPUCxLQUFLSCxFQUFJK0QsaUJBQWlCaEQsU0FBUyxXQUVoRCxTQUFiZixFQUFJNkQsTUFBbUI3RCxFQUFJZ0UsU0FBV2hFLEVBQUlnRSxRQUFRQyxPQUFTLEVBQzlELElBQUssSUFBSTVDLEVBQUksRUFBR0EsRUFBSXJCLEVBQUlnRSxRQUFRQyxPQUFRNUMsSUFDbkNyQixFQUFJZ0UsUUFBUTNDLEdBQUdyRyxjQUFnQnlGLGFBQ2xDVCxFQUFJZ0UsUUFBUTNDLEdBQUtYLEVBQU9QLEtBQUtILEVBQUlnRSxRQUFRM0MsSUFBSU4sU0FBUyxXQUV6RCxPQUFPZixDQUNSLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdG9taXh3YXAvLi9ub2RlX21vZHVsZXMvQHJhbmRsYWJzL2NvbW11bmljYXRpb24tYnJpZGdlL2luZGV4LmpzIiwid2VicGFjazovL2F0b21peHdhcC8uL25vZGVfbW9kdWxlcy9AcmFuZGxhYnMvY29tbXVuaWNhdGlvbi1icmlkZ2UvbGliL21lc3Nlbmdlci5qcyIsIndlYnBhY2s6Ly9hdG9taXh3YXAvLi9ub2RlX21vZHVsZXMvQHJhbmRsYWJzL215YWxnby1jb25uZWN0L2luZGV4LmpzIiwid2VicGFjazovL2F0b21peHdhcC8uL25vZGVfbW9kdWxlcy9AcmFuZGxhYnMvbXlhbGdvLWNvbm5lY3QvbGliL21haW4uanMiLCJ3ZWJwYWNrOi8vYXRvbWl4d2FwLy4vbm9kZV9tb2R1bGVzL0ByYW5kbGFicy9teWFsZ28tY29ubmVjdC9saWIvbWVzc2FnaW5nL01lc3NhZ2luZy5qcyIsIndlYnBhY2s6Ly9hdG9taXh3YXAvLi9ub2RlX21vZHVsZXMvQHJhbmRsYWJzL215YWxnby1jb25uZWN0L2xpYi9wb3B1cC9wb3B1cC5qcyIsIndlYnBhY2s6Ly9hdG9taXh3YXAvLi9ub2RlX21vZHVsZXMvQHJhbmRsYWJzL215YWxnby1jb25uZWN0L2xpYi91dGlscy9lcnJvcnMuanMiLCJ3ZWJwYWNrOi8vYXRvbWl4d2FwLy4vbm9kZV9tb2R1bGVzL0ByYW5kbGFicy9teWFsZ28tY29ubmVjdC9saWIvdXRpbHMvdXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi9saWIvbWVzc2VuZ2VyXCIpO1xuIiwiY2xhc3MgTWVzc2VuZ2VyIHtcblxuXHQvKipcblx0ICogQGNhbGxiYWNrIG9uTWVzc2FnZVxuXHQgKiBAcGFyYW0ge2Vycm9yfSBlcnJcblx0ICogQHBhcmFtIHtPYmplY3R9IHJlc3VsdFxuXHQgKi9cblxuXHQvKipcblx0ICogQGRlc2NyaXB0aW9uIENhbGxiYWNrIGZ1bmN0aW9uIHRvIHNlbmQgcmVzcG9uc2UgdG8gdGhlIHdpbmRvdyBzb3VyY2Ugb2YgdGhlIG1lc3NhZ2Vcblx0ICogQGNhbGxiYWNrIHNlbmRSZXNwb25zZVxuXHQgKiBAcGFyYW0ge09iamVjdH0gcmVzcG9uc2UgTWVzc2FnZSByZXNwb25zZVxuXHQgKiBAcmV0dXJucyB7dm9pZH1cblx0ICovXG5cblx0LyoqXG5cdCAqIEBkZXNjcmlwdGlvbiBDYWxsYmFjayBmdW5jdGlvbiB0byBtYW5hZ2UgbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoZSBjaGFubmVsXG4gICAgICogQGNhbGxiYWNrIG9uTWVzc2FnZUNhbGxiYWNrXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGpzb25cblx0ICogQHBhcmFtIHtXaW5kb3d9IHNvdXJjZVxuICAgICAqIEBwYXJhbSB7c2VuZFJlc3BvbnNlfSBjYlxuXHQgKiBAcGFyYW0ge01lc3Nlbmdlcn0gYnJpZGdlXG5cdCAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuXG5cdC8qKlxuXHQgKiBAZGVzY3JpcHRpb24gU2VuZCBtZXNzYWdlIG9wdGlvbnNcblx0ICogQHR5cGVkZWYge09iamVjdH0gc2VuZE1lc3NhZ2VPcHRpb25zXG5cdCAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gd2FpdEZvclJlcGx5IFdhaXQgZm9yIGEgcmVwbHkgZnJvbSB0aGUgcmVjaXBpZW50XG5cdCAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBvcmlnaW4gT3ZlcnJpZGUgV2luZG93Lm9yaWdpblxuXHQgKiBAcHJvcGVydHkge251bWJlcn0gdGltZW91dCBUaW1lb3V0IHRvIHdhaXQgZm9yIHJlcGx5IG1lc3NhZ2UsIGRlZmF1bHQgNDAwMCBtc2VjXG5cdCAqL1xuXG5cdC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGFubmVsTmFtZSAgQ2hhbm5lbCBOYW1lXG4gICAgICogQHBhcmFtIHtvbk1lc3NhZ2VDYWxsYmFja30gW29uTWVzc2FnZUNhbGxiYWNrXSBDYWxsYmFjayBmdW5jdGlvblxuICAgICAqL1xuXG5cdGNvbnN0cnVjdG9yKGNoYW5uZWxOYW1lLCBvbk1lc3NhZ2VDYWxsYmFjaykge1xuXHRcdHRoaXMuY2hhbm5lbE5hbWUgPSBjaGFubmVsTmFtZTtcblx0XHR0aGlzLm9uTWVzc2FnZSA9IG9uTWVzc2FnZUNhbGxiYWNrO1xuXG5cdFx0dGhpcy5faW5zdGFsbExpc3RlbmVyKCk7XG5cblx0XHQvKipcblx0XHQgKiBAYWNjZXNzIHByaXZhdGVcblx0XHQgKiBAdHlwZWRlZiB7T2JqZWN0LjxzdHJpbmcsIG9uTWVzc2FnZT59IFJlcXVlc3RPYmplY3QgUmVxdWVzdCBvYmplY3RzXG5cdFx0ICogQHR5cGUge1JlcXVlc3RPYmplY3R9IF9yZXF1ZXN0cyBNYXBwaW5nIG9mIHJlcXVlc3QgaWRzIHRvIGNhbGxiYWNrc1xuXHRcdCAqL1xuXHRcdHRoaXMuX3JlcXVlc3RzID0gbmV3IE1hcCgpO1xuXG5cdFx0LyoqXG5cdFx0ICogQGFjY2VzcyBwcml2YXRlXG5cdFx0ICogQHR5cGUge251bWJlcn0gTmV4dCByZXF1ZXN0IGlkXG5cdFx0ICovXG5cdFx0dGhpcy5fbmV4dElkID0gMDtcblxuXHRcdC8qKlxuXHRcdCAqIEBhY2Nlc3MgcHJpdmF0ZVxuXHRcdCAqIEB0eXBlIHtudW1iZXJ9IFRpbWUgdG8gd2FpdCBmb3IgdGhlIG1lc3NhZ2UgcmVzcG9uc2Vcblx0XHQgKi9cblx0XHR0aGlzLl9kZWZhdWx0VGltZW91dCA9IDQwMDA7XG5cdH1cblxuXHQvKipcblx0ICogQGFjY2VzcyBwcml2YXRlXG5cdCAqL1xuXG5cdF9pbnN0YWxsTGlzdGVuZXIoKSB7XG5cdFx0Y29uc3QgdGhhdCA9IHRoaXM7XG5cblx0XHQvKipcblx0XHQgKiBAYWNjZXNzIHByaXZhdGVcblx0XHQgKiBAcGFyYW0ge1dpbmRvd30gdGhpc1xuXHRcdCAqIEBwYXJhbSB7TWVzc2FnZUV2ZW50fSBldmVudFxuXHRcdCAqL1xuXG5cdFx0dGhpcy5fbGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdC8vIElnbm9yZSBpbnZhbGlkIG1lc3NhZ2VzIG9yIHRob3NlIGFmdGVyIHRoZSBjbGllbnQgaGFzIGNsb3NlZFxuXHRcdFx0aWYgKCFldmVudC5kYXRhIHx8IHR5cGVvZiBldmVudC5kYXRhICE9PSAnc3RyaW5nJykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGxldCBqc29uO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRqc29uID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcblx0XHRcdFx0aWYgKCFqc29uLmNoYW5uZWwgfHwganNvbi5jaGFubmVsICE9PSB0aGF0LmNoYW5uZWxOYW1lKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0eXBlb2YganNvbi5tZXNzYWdlICE9PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y2F0Y2ggKGVycikge1xuXHRcdFx0XHQgLy8gSWdub3JlIG1hbGZvcm1lZCBtZXNzYWdlcyBvciBub3QgdGFyZ2V0dGluZyB1c1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFkZCByZXF1ZXN0IGNhbGxiYWNrXG5cdFx0XHRpZiAodHlwZW9mIGpzb24ucmVwbHlJZCAhPT0gJ3VuZGVmaW5lZCcpIHtcblxuXHRcdFx0XHRpZiAodHlwZW9mIGpzb24ucmVwbHlJZCAhPT0gJ251bWJlcicgfHwgKGpzb24ucmVwbHlJZCAlIDEpICE9PSAwKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gSWYgd2UgaGF2ZSBhIG1lc3NhZ2Ugd2FpdGluZyBmb3IgYSByZXBseSwgcHJvY2VzcyBpdCwgZWxzZSBpZ25vcmVcblx0XHRcdFx0Y29uc3QgcmVxID0gdGhhdC5fcmVxdWVzdHMuZ2V0KGpzb24ucmVwbHlJZCk7XG5cdFx0XHRcdGlmIChyZXEpIHtcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQocmVxLnRpbWVvdXQpO1xuXG5cdFx0XHRcdFx0dGhhdC5fcmVxdWVzdHMuZGVsZXRlKGpzb24ucmVwbHlJZCk7XG5cblx0XHRcdFx0XHRyZXEucmVzb2x2ZShqc29uLm1lc3NhZ2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0aWYgKHR5cGVvZiBqc29uLmlkICE9PSAnbnVtYmVyJyB8fCAoanNvbi5pZCAlIDEpICE9PSAwIHx8ICF0aGF0Lm9uTWVzc2FnZSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFdlIHJlY2VpdmVkIGEgbWVzc2FnZVxuXHRcdFx0XHRjb25zdCBjaGFubmVsID0gdGhhdC5jaGFubmVsTmFtZTtcblx0XHRcdFx0Y29uc3QgcmVwbHlJZCA9IGpzb24uaWQ7XG5cdFx0XHRcdGNvbnN0IG9yaWdpbiA9IGV2ZW50Lm9yaWdpbjtcblxuXHRcdFx0XHRjb25zdCByZXBseU1lc3NhZ2UgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuXHRcdFx0XHRcdGNvbnN0IHJlcXVlc3QgPSB7XG5cdFx0XHRcdFx0XHRjaGFubmVsLFxuXHRcdFx0XHRcdFx0cmVwbHlJZCxcblx0XHRcdFx0XHRcdG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGV2ZW50LnNvdXJjZS5wb3N0TWVzc2FnZShcblx0XHRcdFx0XHRcdEpTT04uc3RyaW5naWZ5KHJlcXVlc3QpLFxuXHRcdFx0XHRcdFx0b3JpZ2luXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHR0aGF0Lm9uTWVzc2FnZShqc29uLm1lc3NhZ2UsIGV2ZW50Lm9yaWdpbiwgZXZlbnQuc291cmNlLCByZXBseU1lc3NhZ2UsIHRoYXQpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5fbGlzdGVuZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEBhY2Nlc3MgcHVibGljXG5cdCAqIEBkZXNjcmlwdGlvbiBTZW5kIGEgbWVzc2FnZSB0byBhbm90aGVyIHdpbmRvd1xuXHQgKiBAcGFyYW0ge1dpbmRvd30gdGFyZ2V0V2luZG93IFRhcmdldCBXaW5kb3dcblx0ICogQHBhcmFtIHtPYmplY3R9IG1lc3NhZ2UgT2JqZWN0IE1lc3NhZ2Vcblx0ICogQHBhcmFtIHtzdHJpbmd9IG9yaWdpbiBUYXJnZXQgb3JpZ2luXG5cdCAqIEBwYXJhbSB7c2VuZE1lc3NhZ2VPcHRpb25zfSBbb3B0aW9uc10gT2JqZWN0IE1lc3NhZ2Vcblx0ICogQHJldHVybnMge1Byb21pc2U8YW55Pn0gUmV0dXJuc1xuXHQgKi9cblx0c2VuZE1lc3NhZ2UodGFyZ2V0V2luZG93LCBtZXNzYWdlLCBvcmlnaW4sIG9wdGlvbnMpIHtcblx0XHQvLyBQcmVwYXJlIG1lc3NhZ2Vcblx0XHRjb25zdCByZXF1ZXN0ID0ge1xuXHRcdFx0Y2hhbm5lbDogdGhpcy5jaGFubmVsTmFtZSxcblx0XHRcdGlkOiB0aGlzLmdldE5leHRJZCgpLFxuXHRcdFx0bWVzc2FnZTogbWVzc2FnZSxcblx0XHR9O1xuXG5cdFx0aWYgKG9wdGlvbnMgJiYgb3B0aW9ucy53YWl0Rm9yUmVwbHkpIHtcblx0XHRcdGNvbnN0IHRoYXQgPSB0aGlzO1xuXG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHQvLyBTZXQgYSB0aW1lb3V0IGlmIGEgcmVzcG9uc2UgaXMgbm90IHJlY2VpdmVkXG5cdFx0XHRcdGNvbnN0IHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNvbnN0IHJlcSA9IHRoYXQuX3JlcXVlc3RzLmdldChyZXF1ZXN0LmlkKTtcblx0XHRcdFx0XHRpZiAocmVxKSB7XG5cdFx0XHRcdFx0XHR0aGF0Ll9yZXF1ZXN0cy5kZWxldGUocmVxdWVzdC5pZCk7XG5cblx0XHRcdFx0XHRcdHJlamVjdChuZXcgRXJyb3IoJ1RpbWVvdXQgZXhwaXJlZCBmb3IgdGhlIG1lc3NhZ2UgcmVzcG9uc2UnKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCBvcHRpb25zICYmIG9wdGlvbnMudGltZW91dCA/IG9wdGlvbnMudGltZW91dCA6IHRoYXQuX2RlZmF1bHRUaW1lb3V0KTtcblxuXHRcdFx0XHR0aGF0Ll9yZXF1ZXN0cy5zZXQocmVxdWVzdC5pZCwge1xuXHRcdFx0XHRcdHRpbWVvdXQsXG5cdFx0XHRcdFx0cmVzb2x2ZVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR0YXJnZXRXaW5kb3cucG9zdE1lc3NhZ2UoXG5cdFx0XHRcdFx0SlNPTi5zdHJpbmdpZnkocmVxdWVzdCksXG5cdFx0XHRcdFx0b3JpZ2luXG5cdFx0XHRcdCk7XG5cdFx0XHR9KTtcblxuXHRcdH1cblx0XHR0YXJnZXRXaW5kb3cucG9zdE1lc3NhZ2UoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShyZXF1ZXN0KSxcblx0XHRcdG9yaWdpblxuXHRcdCk7XG5cdH1cblxuXHQvKipcblx0ICogQGFjY2VzcyBwdWJsaWNcblx0ICogQGRlc2NyaXB0aW9uIENsb3NlIGNsaWVudCBjb25uZWN0aW9uXG5cdCAqL1xuXG5cdGNsb3NlKCkge1xuXHRcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5fbGlzdGVuZXIpO1xuXHRcdHRoaXMuX2xpc3RlbmVyID0gbnVsbDtcblx0XHRkZWxldGUgdGhpcy5fcmVxdWVzdHM7XG5cdH1cblxuXHQvKipcblx0ICogQGFjY2VzcyBwcml2YXRlXG5cdCAqL1xuXG5cdGdldE5leHRJZCgpIHtcblx0XHR0aGlzLl9uZXh0SWQgKz0gMTtcblx0XHRyZXR1cm4gdGhpcy5fbmV4dElkO1xuXHR9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gTWVzc2VuZ2VyO1xuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi9saWIvbWFpblwiKTtcbiIsImNvbnN0IHsgb3BlblBvcHVwIH0gPSByZXF1aXJlKFwiLi9wb3B1cC9wb3B1cFwiKTtcbmNvbnN0IHsgc2xlZXAsIHByZXBhcmVUeG4gfSA9IHJlcXVpcmUoXCIuL3V0aWxzL3V0aWxzXCIpO1xuY29uc3QgRXJyb3JzID0gcmVxdWlyZShcIi4vdXRpbHMvZXJyb3JzXCIpO1xuXG5jb25zdCBNZXNzYWdpbmcgPSByZXF1aXJlKFwiLi9tZXNzYWdpbmcvTWVzc2FnaW5nXCIpO1xuXG4vKipcbiAqIEB0eXBlIHtNZXNzYWdpbmcgfCBudWxsfVxuICovXG5sZXQgYnJpZGdlID0gbnVsbDtcblxuLyoqXG4gKiBAZGVzY3JpcHRpb24gVHJhbnNhY3Rpb24gaGFzaFxuICogQHR5cGVkZWYgVHhIYXNoXG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIEJhc2U2NCBzdHJpbmdcbiAqIEB0eXBlZGVmIEJhc2U2NFxuICogQHR5cGUge3N0cmluZ31cbiAqL1xuXG4vKipcbiAgKiBAZGVzY3JpcHRpb24gT3B0aW9uc1xuICAqIEB0eXBlZGVmIE9wdGlvbnNcbiAgKiBAdHlwZSB7b2JqZWN0fVxuICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbYnJpZGdlVXJsXSBPdmVycmlkZSB3YWxsZXQubXlhbGdvLmNvbSBkZWZhdWx0IGZyYW1lIHVybC5cbiAgKiBAcHJvcGVydHkge251bWJlcn0gW3RpbWVvdXRdIE51bWJlciBvZiBtc2VjIHRvIHdhaXQgdGhlIHBvcHVwIHJlc3BvbnNlLCBkZWZhdWx0IHZhbHVlOiAxNjAwMDAwIG1zZWMuXG4gICogQHByb3BlcnR5IHtib29sZWFufSBbZGlzYWJsZUxlZGdlck5hbm9dIEl0IHdpbGwgZGlzYWJsZSBsZWRnZXIgbmFubyBhY2NvdW50cyBhbmQgcmV0dXJucyBvbmx5IG1uZW1vbmljIGFjY291bnRzLlxuICAqL1xuXG4vKipcbiAgKiBAZGVzY3JpcHRpb24gU2lnbiB0cmFuc2FjdGlvbiBvcHRpb25zXG4gICogQHR5cGVkZWYgU2lnblRyYW5zYWN0aW9uT3B0aW9uc1xuICAqIEB0eXBlIHtvYmplY3R9XG4gICogQHByb3BlcnR5IHtBZGRyZXNzfSBbb3ZlcnJpZGVTaWduZXJdIEZvcmNlIHRyYW5zYWN0aW9ucyB0byBiZSBzaWduZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGFjY291bnQgaW5zdGVhZCBvZiB0aGUgZnJvbS9hdXRoIGFkZHJlc3MuXG4gICovXG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIENvbm5lY3QgbWV0aG9kIHNldHRpbmdzXG4gKiBAdHlwZWRlZiBDb25uZWN0aW9uU2V0dGluZ3NcbiAqIEB0eXBlIHtvYmplY3R9XG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtzaG91bGRTZWxlY3RPbmVBY2NvdW50XSBPbmx5IHJldHVybnMgb25lIGFjY291bnRcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW29wZW5NYW5hZ2VyXSBPcGVuIGFjY291bnQgbWFuYWdlclxuICovXG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIEFsZ29yYW5kIGFjY291bnQgYWRkcmVzc1xuICogQHR5cGVkZWYgQWRkcmVzc1xuICogQHR5cGUge3N0cmluZ31cbiAqL1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvbiBQYXltZW50IHRyYW5zYWN0aW9uIG9iamVjdFxuICogQHR5cGVkZWYgUGF5bWVudFR4blxuICogQHR5cGUge29iamVjdH1cbiAqIEBwcm9wZXJ0eSB7XCJwYXlcIn0gdHlwZSBUcmFuc2FjdGlvbiB0eXBlXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IGZyb20gU2VuZGVyIEFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gW3RvXSBSZWNlaXZlciBBZGRyZXNzXG4gKiBAcHJvcGVydHkge251bWJlcn0gZmVlIFRyYW5zYWN0aW9uIGZlZSAoaW4gbUFsZ29zKVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFthbW91bnRdIEFtb3VudCB0byB0cmFuc2ZlciAoaW4gbUFsZ29zKVxuICogQHByb3BlcnR5IHtudW1iZXJ9IGZpcnN0Um91bmQgRmlyc3QgYmxvY2sgcm91bmRcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBsYXN0Um91bmQgTGFzdCBibG9jayByb3VuZFxuICogQHByb3BlcnR5IHtVaW50OEFycmF5fEJhc2U2NH0gW25vdGVdIFRyYW5zYWN0aW9uIG5vdGVcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBnZW5lc2lzSUQgQWxnb3JhbmQgbmV0d29yayBnZW5lc2lzIElEXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZ2VuZXNpc0hhc2ggQWxnb3JhbmQgbmV0d29yayBnZW5lc2lzIGhhc2hcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gW3JlS2V5VG9dIENoYW5nZSBzaWduZXIgYWRkcmVzc1xuICogQHByb3BlcnR5IHtib29sZWFufSBbZmxhdEZlZV0gZmxhdEZlZSAoZGVmYXVsdDogZmFsc2UpXG4gKiBAcHJvcGVydHkge0J1ZmZlcnxCYXNlNjR9IFtncm91cF0gR3JvdXAgaWRcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gW2Nsb3NlUmVtYWluZGVyVG9dIENsb3NlIHJlbWFpbmRlciB0byBhZGRyZXNzXG4gKi9cblxuLyoqXG4gKiBAZGVzY3JpcHRpb24gQXNzZXQgdHJhbnNmZXIgdHJhbnNhY3Rpb24gb2JqZWN0XG4gKiBAdHlwZWRlZiBBc3NldFRyYW5zZmVyVHhuXG4gKiBAdHlwZSB7b2JqZWN0fVxuICogQHByb3BlcnR5IHtcImF4ZmVyXCJ9IHR5cGUgVHJhbnNhY3Rpb24gdHlwZVxuICogQHByb3BlcnR5IHtBZGRyZXNzfSBmcm9tIFNlbmRlciBBZGRyZXNzXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IFt0b10gUmVjZWl2ZXIgQWRkcmVzc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IGZlZSBUcmFuc2FjdGlvbiBmZWUgKGluIG1BbGdvcylcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbYW1vdW50XSBBbW91bnQgdG8gdHJhbnNmZXIgKGluIG1BbGdvcylcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmaXJzdFJvdW5kIEZpcnN0IGJsb2NrIHJvdW5kXG4gKiBAcHJvcGVydHkge251bWJlcn0gbGFzdFJvdW5kIExhc3QgYmxvY2sgcm91bmRcbiAqIEBwcm9wZXJ0eSB7VWludDhBcnJheXxCYXNlNjR9IFtub3RlXSBUcmFuc2FjdGlvbiBub3RlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZ2VuZXNpc0lEIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBJRFxuICogQHByb3BlcnR5IHtzdHJpbmd9IGdlbmVzaXNIYXNoIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBoYXNoXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IFtyZUtleVRvXSBDaGFuZ2Ugc2lnbmVyIGFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW2ZsYXRGZWVdIGZsYXRGZWUgKGRlZmF1bHQ6IGZhbHNlKVxuICogQHByb3BlcnR5IHtBZGRyZXNzfSBbc2lnbmVyXSBTaWduZXIgYWRkcmVzc1xuICogQHByb3BlcnR5IHtCdWZmZXJ8QmFzZTY0fSBbZ3JvdXBdIEdyb3VwIGlkXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IFtjbG9zZVJlbWFpbmRlclRvXSBDbG9zZSByZW1haW5kZXIgdG8gYWRkcmVzc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IFthc3NldEluZGV4XSBBc3NldCBpbmRleFxuICogQHByb3BlcnR5IHtBZGRyZXNzfSBbYXNzZXRSZXZvY2F0aW9uVGFyZ2V0XSBBc3NldCByZXZvY2F0aW9uIGFkZHJlc3NcbiAqL1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvbiBBc3NldCBjb25maWd1cmF0aW9uIHRyYW5zYWN0aW9uIG9iamVjdFxuICogQHR5cGVkZWYgQXNzZXRDb25maWdUeG5cbiAqIEB0eXBlIHtvYmplY3R9XG4gKiBAcHJvcGVydHkge1wiYWNmZ1wifSB0eXBlIFRyYW5zYWN0aW9uIHR5cGVcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gZnJvbSBTZW5kZXIgQWRkcmVzc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IGZlZSBUcmFuc2FjdGlvbiBmZWUgKGluIG1BbGdvcylcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmaXJzdFJvdW5kIEZpcnN0IGJsb2NrIHJvdW5kXG4gKiBAcHJvcGVydHkge251bWJlcn0gbGFzdFJvdW5kIExhc3QgYmxvY2sgcm91bmRcbiAqIEBwcm9wZXJ0eSB7VWludDhBcnJheXxCYXNlNjR9IFtub3RlXSBUcmFuc2FjdGlvbiBub3RlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZ2VuZXNpc0lEIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBJRFxuICogQHByb3BlcnR5IHtzdHJpbmd9IGdlbmVzaXNIYXNoIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBoYXNoXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IFtyZUtleVRvXSBDaGFuZ2Ugc2lnbmVyIGFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW2ZsYXRGZWVdIGZsYXRGZWUgKGRlZmF1bHQ6IGZhbHNlKVxuICogQHByb3BlcnR5IHtBZGRyZXNzfSBbc2lnbmVyXSBTaWduZXIgYWRkcmVzc1xuICogQHByb3BlcnR5IHtCdWZmZXJ8QmFzZTY0fSBbZ3JvdXBdIEdyb3VwIGlkXG4gKiBAcHJvcGVydHkge251bWJlcn0gW2Fzc2V0SW5kZXhdIEFzc2V0IGluZGV4XG4gKiBAcHJvcGVydHkge251bWJlcn0gW2Fzc2V0VG90YWxdIEFzc2V0IHRvdGFsIHN1cHBseVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFthc3NldERlY2ltYWxzXSBBc3NldCBkZWNpbWFsc1xuICogQHByb3BlcnR5IHtib29sZWFufSBbYXNzZXREZWZhdWx0RnJvemVuXSBEZWZhdWx0IGZyb3plblxuICogQHByb3BlcnR5IHtBZGRyZXNzfSBbYXNzZXRNYW5hZ2VyXSBBc3NldCBtYW5hZ2VyIGFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gW2Fzc2V0UmVzZXJ2ZV0gQXNzZXQgcmVzZXJ2ZSBhZGRyZXNzXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IFthc3NldEZyZWV6ZV0gQXNzZXQgZnJlZXplIGFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gW2Fzc2V0Q2xhd2JhY2tdIEFzc2V0IGNsYXdiYWNrIGFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbYXNzZXRVbml0TmFtZV0gQXNzZXQgdW5pdCBuYW1lXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2Fzc2V0TmFtZV0gQXNzZXQgbmFtZVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFthc3NldFVSTF0gQXNzZXQgdXJsXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2Fzc2V0TWV0YWRhdGFIYXNoXSBBc3NldCBtZXRhZGF0YSBoYXNoXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtzdHJpY3RFbXB0eUFkZHJlc3NDaGVja2luZ11cbiAqL1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvbiBLZXkgcmVnaXN0cmF0aW9uIHRyYW5zYWN0aW9uIG9iamVjdFxuICogQHR5cGVkZWYgS2V5UmVnVHhuXG4gKiBAdHlwZSB7b2JqZWN0fVxuICogQHByb3BlcnR5IHtcImtleXJlZ1wifSB0eXBlIFRyYW5zYWN0aW9uIHR5cGVcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gZnJvbSBTZW5kZXIgQWRkcmVzc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IGZlZSBUcmFuc2FjdGlvbiBmZWUgKGluIG1BbGdvcylcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmaXJzdFJvdW5kIEZpcnN0IGJsb2NrIHJvdW5kXG4gKiBAcHJvcGVydHkge251bWJlcn0gbGFzdFJvdW5kIExhc3QgYmxvY2sgcm91bmRcbiAqIEBwcm9wZXJ0eSB7VWludDhBcnJheXxCYXNlNjR9IFtub3RlXSBUcmFuc2FjdGlvbiBub3RlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZ2VuZXNpc0lEIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBJRFxuICogQHByb3BlcnR5IHtzdHJpbmd9IGdlbmVzaXNIYXNoIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBoYXNoXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IFtyZUtleVRvXSBDaGFuZ2Ugc2lnbmVyIGFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW2ZsYXRGZWVdIGZsYXRGZWUgKGRlZmF1bHQ6IGZhbHNlKVxuICogQHByb3BlcnR5IHtBZGRyZXNzfSBbc2lnbmVyXSBTaWduZXIgYWRkcmVzc1xuICogQHByb3BlcnR5IHtCdWZmZXJ8QmFzZTY0fSBbZ3JvdXBdIEdyb3VwIGlkXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3ZvdGVLZXldIFZvdGUga2V5XG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3NlbGVjdGlvbktleV0gU2VsZWN0aW9uIGtleVxuICogQHByb3BlcnR5IHtudW1iZXJ9IHZvdGVGaXJzdCBWb3RlIGZpcnN0IHJvdW5kXG4gKiBAcHJvcGVydHkge251bWJlcn0gdm90ZUxhc3QgVm90ZSBsYXN0IHJvdW5kXG4gKiBAcHJvcGVydHkge251bWJlcn0gW3ZvdGVLZXlEaWx1dGlvbl0gVm90ZSBrZXkgZGlsdXRpb25cbiAqL1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvbiBBcHBsaWNhdGlvbiBjYWxsIHRyYW5zYWN0aW9uIG9iamVjdFxuICogQHR5cGVkZWYgQXBwbGljYXRpb25UeG5cbiAqIEB0eXBlIHtvYmplY3R9XG4gKiBAcHJvcGVydHkge1wiYXBwbFwifSB0eXBlIFRyYW5zYWN0aW9uIHR5cGVcbiAqIEBwcm9wZXJ0eSB7QWRkcmVzc30gZnJvbSBTZW5kZXIgQWRkcmVzc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IGZlZSBUcmFuc2FjdGlvbiBmZWUgKGluIG1BbGdvcylcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmaXJzdFJvdW5kIEZpcnN0IGJsb2NrIHJvdW5kXG4gKiBAcHJvcGVydHkge251bWJlcn0gbGFzdFJvdW5kIExhc3QgYmxvY2sgcm91bmRcbiAqIEBwcm9wZXJ0eSB7VWludDhBcnJheXxCYXNlNjR9IFtub3RlXSBUcmFuc2FjdGlvbiBub3RlXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZ2VuZXNpc0lEIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBJRFxuICogQHByb3BlcnR5IHtzdHJpbmd9IGdlbmVzaXNIYXNoIEFsZ29yYW5kIG5ldHdvcmsgZ2VuZXNpcyBoYXNoXG4gKiBAcHJvcGVydHkge0FkZHJlc3N9IFtyZUtleVRvXSBDaGFuZ2Ugc2lnbmVyIGFkZHJlc3NcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW2ZsYXRGZWVdIGZsYXRGZWUgKGRlZmF1bHQ6IGZhbHNlKVxuICogQHByb3BlcnR5IHtBZGRyZXNzfSBbc2lnbmVyXSBTaWduZXIgYWRkcmVzc1xuICogQHByb3BlcnR5IHtCdWZmZXJ8QmFzZTY0fSBbZ3JvdXBdIEdyb3VwIGlkXG4gKiBAcHJvcGVydHkge251bWJlcn0gW2FwcEluZGV4XSBBcHBsaWNhdGlvbiBpZFxuICogQHByb3BlcnR5IHswfDF8MnwzfDR8NX0gW2FwcE9uQ29tcGxldGVdXG4gKiBAcHJvcGVydHkge251bWJlcn0gW2FwcExvY2FsSW50c11cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbYXBwTG9jYWxCeXRlU2xpY2VzXVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFthcHBHbG9iYWxJbnRzXVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFthcHBHbG9iYWxCeXRlU2xpY2VzXVxuICogQHByb3BlcnR5IHtVaW50OEFycmF5fEJhc2U2NH0gW2FwcEFwcHJvdmFsUHJvZ3JhbV1cbiAqIEBwcm9wZXJ0eSB7VWludDhBcnJheXxCYXNlNjR9IFthcHBDbGVhclByb2dyYW1dXG4gKiBAcHJvcGVydHkge1VpbnQ4QXJyYXlbXXxCYXNlNjRbXX0gW2FwcEFyZ3NdXG4gKiBAcHJvcGVydHkge0FkZHJlc3NbXX0gW2FwcEFjY291bnRzXVxuICogQHByb3BlcnR5IHtudW1iZXJbXX0gW2FwcEZvcmVpZ25BcHBzXVxuICogQHByb3BlcnR5IHtudW1iZXJbXX0gW2FwcEZvcmVpZ25Bc3NldHNdXG4gKi9cblxuLyoqXG4gKiBAZGVzY3JpcHRpb24gVHJhbnNhY3Rpb24gT2JqZWN0XG4gKiBAdHlwZWRlZiBUcmFuc2FjdGlvblxuICogQHR5cGUge1BheW1lbnRUeG4gfCBBc3NldFRyYW5zZmVyVHhuIHwgQXNzZXRDb25maWdUeG4gfCBLZXlSZWdUeG4gfCBBcHBsaWNhdGlvblR4bn1cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIEVuY29kZWRUcmFuc2FjdGlvblxuICogQHR5cGUge1VpbnQ4QXJyYXl8QmFzZTY0fSBBbGdvcmFuZCBFbmNvZGVkIFRyYW5zYWN0aW9uXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiBTaWduZWRUeFxuICogQHR5cGUge29iamVjdH1cbiAqIEBwcm9wZXJ0eSB7VHhIYXNofSB0eElEIFRyYW5zYWN0aW9uIGhhc2hcbiAqIEBwcm9wZXJ0eSB7VWludDhBcnJheX0gYmxvYiBTaWduZWQgdHJhbnNhY3Rpb25cbiAqL1xuXG5jbGFzcyBNeUFsZ29Db25uZWN0IHtcblxuXHQvKipcblx0ICogQGNvbnN0cnVjdG9yXG5cdCAqIEBwYXJhbSB7T3B0aW9uc30gW29wdGlvbnNdIE9wZXJhdGlvbiBvcHRpb25zXG5cdCAqL1xuXHRjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG5cblx0XHRpZiAoIWJyaWRnZSkge1xuXHRcdFx0YnJpZGdlID0gbmV3IE1lc3NhZ2luZygpO1xuXHRcdH1cblxuXHRcdC8qKlxuXHRcdCAqIEBhY2Nlc3MgcHJpdmF0ZVxuXHRcdCAqIEB0eXBlIHtNZXNzYWdpbmd9XG5cdFx0ICovXG5cdFx0dGhpcy5icmlkZ2UgPSBicmlkZ2U7XG5cblx0XHQvKipcblx0XHQgKiBAYWNjZXNzIHByaXZhdGVcblx0XHQgKiBAdHlwZSB7bnVtYmVyfSBQb3B1cCBUaW1lb3V0XG5cdFx0ICovXG5cdFx0dGhpcy50aW1lb3V0ID0gKG9wdGlvbnMgJiYgb3B0aW9ucy50aW1lb3V0ID8gb3B0aW9ucy50aW1lb3V0IDogMTYwMDAwMCk7XG5cblx0XHQvKipcblx0XHQgKiBAYWNjZXNzIHByaXZhdGVcblx0XHQgKiBAdHlwZSB7c3RyaW5nfSBGcmFtZSB1cmxcblx0XHQgKi9cblx0XHR0aGlzLnVybCA9IChvcHRpb25zICYmIG9wdGlvbnMuYnJpZGdlVXJsID8gb3B0aW9ucy5icmlkZ2VVcmwgOiBcImh0dHBzOi8vd2FsbGV0Lm15YWxnby5jb20vYnJpZGdlXCIpO1xuXG5cdFx0aWYgKHRoaXMudXJsLmVuZHNXaXRoKFwiL1wiKSlcblx0XHRcdHRoaXMudXJsID0gdGhpcy51cmwuc2xpY2UoMCwgLTEpO1xuXG5cdFx0LyoqXG5cdFx0ICogQGFjY2VzcyBwcml2YXRlXG5cdFx0ICogQGRlc2NyaXB0aW9uIFRoaXMgaXMgdXNlZCB0byByZXVzZSB0aGUgY3VycmVudCBjb25uZWN0IG9wZW5lZCBwb3B1cFxuXHRcdCAqIEB0eXBlIHtXaW5kb3d8bnVsbH1cblx0XHQgKi9cblx0XHR0aGlzLmN1cnJlbnRDb25uZWN0UG9wdXAgPSBudWxsO1xuXG5cdFx0LyoqXG5cdFx0ICogQGFjY2VzcyBwcml2YXRlXG5cdFx0ICogQGRlc2NyaXB0aW9uIFRoaXMgaXMgdXNlZCB0byByZXVzZSB0aGUgY3VycmVudCBzaWdudHggb3BlbmVkIHBvcHVwXG5cdFx0ICogQHR5cGUge1dpbmRvd3xudWxsfVxuXHRcdCAqL1xuXHRcdHRoaXMuY3VycmVudFNpZ250eFBvcHVwID0gbnVsbDtcblxuXHRcdC8qKlxuXHRcdCAqIEBhY2Nlc3MgcHJpdmF0ZVxuXHRcdCAqIEBkZXNjcmlwdGlvbiBUaGlzIGlzIHVzZWQgdG8gcmV1c2UgdGhlIGN1cnJlbnQgc2lnbmxvZ2ljIG9wZW5lZCBwb3B1cFxuXHRcdCAqIEB0eXBlIHtXaW5kb3d8bnVsbH1cblx0XHQgKi9cblx0XHR0aGlzLmN1cnJlbnRTaWduTG9naWNTaWdQb3B1cCA9IG51bGw7XG5cblx0XHQvKipcblx0XHQgKiBAYWNjZXNzIHByaXZhdGVcblx0XHQgKiBAZGVzY3JpcHRpb24gVGhpcyBpcyB1c2VkIHRvIHJldXNlIHRoZSBjdXJyZW50IHRlYWxzaWduIG9wZW5lZCBwb3B1cFxuXHRcdCAqIEB0eXBlIHtXaW5kb3d8bnVsbH1cblx0XHQgKi9cblx0XHR0aGlzLmN1cnJlbnRUZWFsU2lnblBvcHVwID0gbnVsbDtcblxuXHRcdC8qKlxuXHRcdCAqIEBhY2Nlc3MgcHJpdmF0ZVxuXHRcdCAqIEBkZXNjcmlwdGlvbiBSZXBsYWNlIGRlZmF1bHQgYnJpZGdlIG9wdGlvbnNcblx0XHQgKiBAdHlwZSB7aW1wb3J0KFwiQHJhbmRsYWJzL2NvbW11bmljYXRpb24tYnJpZGdlXCIpLnNlbmRNZXNzYWdlT3B0aW9uc31cblx0XHQgKi9cblx0XHR0aGlzLm9wdGlvbnMgPSB7IHdhaXRGb3JSZXBseTogdHJ1ZSwgdGltZW91dDogdGhpcy50aW1lb3V0IH07XG5cblx0XHQvKipcblx0XHQgKiBAYWNjZXNzIHByaXZhdGVcblx0XHQgKiBAZGVzY3JpcHRpb24gRGlzYWJsZSBsZWRnZXIgbmFub1xuXHRcdCAqIEB0eXBlIHtib29sZWFufVxuXHRcdCAqL1xuXHRcdHRoaXMuZGlzYWJsZUxlZGdlck5hbm8gPSAob3B0aW9ucyAmJiBvcHRpb25zLmRpc2FibGVMZWRnZXJOYW5vKSA/IG9wdGlvbnMuZGlzYWJsZUxlZGdlck5hbm8gOiBmYWxzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBAYXN5bmNcblx0ICogQGFjY2VzcyBwdWJsaWNcblx0ICogQGRlc2NyaXB0aW9uIE9wZW4gYSBuZXcgd2luZG93IHRvIGxvYWQgYWNjb3VudHMgZnJvbSBzdG9yYWdlLlxuXHQgKiBAcGFyYW0ge0Nvbm5lY3Rpb25TZXR0aW5nc30gc2V0dGluZ3MgQ29ubmVjdCBzZXR0aW5nc1xuXHQgKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmdbXT59IFJldHVybnMgYWxsb3dlZCBhY2NvdW50cyBieSB0aGUgdXNlci5cblx0ICovXG5cdGFzeW5jIGNvbm5lY3Qoc2V0dGluZ3MgPSB7IHNob3VsZFNlbGVjdE9uZUFjY291bnQ6IGZhbHNlLCBvcGVuTWFuYWdlcjogZmFsc2UgfSkge1xuXG5cdFx0aWYgKHRoaXMuY3VycmVudENvbm5lY3RQb3B1cCkge1xuXHRcdFx0aWYgKHRoaXMuY3VycmVudENvbm5lY3RQb3B1cC5jbG9zZWQpIHtcblx0XHRcdFx0dGhpcy5jdXJyZW50Q29ubmVjdFBvcHVwID0gbnVsbDtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR0aGlzLmZvY3VzV2luZG93KHRoaXMuY3VycmVudENvbm5lY3RQb3B1cCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdHRoaXMuY3VycmVudENvbm5lY3RQb3B1cCA9IG9wZW5Qb3B1cCh0aGlzLnVybCArIFwiL2Nvbm5lY3QuaHRtbFwiKTtcblxuXHRcdFx0YXdhaXQgdGhpcy53YWl0Rm9yV2luZG93VG9Mb2FkKHRoaXMuY3VycmVudENvbm5lY3RQb3B1cCk7XG5cblx0XHRcdGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuYnJpZGdlLnNlbmRNZXNzYWdlKFxuXHRcdFx0XHR0aGlzLmN1cnJlbnRDb25uZWN0UG9wdXAsXG5cdFx0XHRcdHsgbWV0aG9kOiBcInVubG9ja1wiLCBwYXJhbXM6IE9iamVjdC5hc3NpZ24oc2V0dGluZ3MsIHsgZGlzYWJsZUxlZGdlck5hbm86IHRoaXMuZGlzYWJsZUxlZGdlck5hbm8gfSkgfSxcblx0XHRcdFx0dGhpcy51cmwsIHRoaXMub3B0aW9uc1xuXHRcdFx0KTtcblxuXHRcdFx0dGhpcy5jbG9zZVdpbmRvdyh0aGlzLmN1cnJlbnRDb25uZWN0UG9wdXApO1xuXHRcdFx0dGhpcy5jdXJyZW50Q29ubmVjdFBvcHVwID0gbnVsbDtcblxuXHRcdFx0aWYgKHJlcy5zdGF0dXMgPT09IFwiZXJyb3JcIilcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKHJlcy5tZXNzYWdlKTtcblxuXHRcdFx0cmV0dXJuIHJlcy5kYXRhLmFjY291bnRzO1xuXHRcdH1cblx0XHRjYXRjaCAoZXJyKSB7XG5cdFx0XHR0aGlzLmNsb3NlV2luZG93KHRoaXMuY3VycmVudENvbm5lY3RQb3B1cCk7XG5cdFx0XHR0aGlzLmN1cnJlbnRDb25uZWN0UG9wdXAgPSBudWxsO1xuXHRcdFx0dGhyb3cgZXJyO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBAYXN5bmNcblx0ICogQGFjY2VzcyBwdWJsaWNcblx0ICogQGRlc2NyaXB0aW9uIE9wZW4gYSBuZXcgd2luZG93IHRvIHNpZ24gdHJhbnNhY3Rpb24uXG5cdCAqIEBwYXJhbSB7VHJhbnNhY3Rpb258VHJhbnNhY3Rpb25bXXxFbmNvZGVkVHJhbnNhY3Rpb258RW5jb2RlZFRyYW5zYWN0aW9uW119IHRyYW5zYWN0aW9uIFRyYW5zYWN0aW9uIG9iamVjdCBvciBhIFRyYW5zYWN0aW9uIGFycmF5LlxuXHQgKiBAcGFyYW0ge1NpZ25UcmFuc2FjdGlvbk9wdGlvbnN9IFtzaWduT3B0aW9uc10gU2lnbiB0cmFuc2FjdGlvbnMgb3B0aW9ucyBvYmplY3QuXG5cdCAqIChUaGUgc2lnbmVyIGFjY291bnQgbXVzdCBiZSB0aGUgc2FtZSBmb3IgYWxsIHRyYW5zYWN0aW9ucykuXG5cdCAqIEByZXR1cm5zIHsoU2lnbmVkVHh8U2lnbmVkVHhbXSl9IFJldHVybnMgdHJhbnNhY3Rpb24gYmxvYiBvciBhbiBBcnJheSBvZiBibG9icywgZGVwZW5kcyBpZiB0aGVcblx0ICogdHJhbnNhY3Rpb24gd2FzIGFuIG9iamVjdCBvciBhbiBhcnJheS5cblx0ICovXG5cdGFzeW5jIHNpZ25UcmFuc2FjdGlvbih0cmFuc2FjdGlvbiwgc2lnbk9wdGlvbnMpIHtcblx0XHRsZXQgdHhuO1xuXG5cdFx0aWYgKHRoaXMuY3VycmVudFNpZ250eFBvcHVwKSB7XG5cdFx0XHRpZiAodGhpcy5jdXJyZW50U2lnbnR4UG9wdXAuY2xvc2VkKSB7XG5cdFx0XHRcdHRoaXMuY3VycmVudFNpZ250eFBvcHVwID0gbnVsbDtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR0aGlzLmZvY3VzV2luZG93KHRoaXMuY3VycmVudFNpZ250eFBvcHVwKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoQXJyYXkuaXNBcnJheSh0cmFuc2FjdGlvbikpXG5cdFx0XHR0eG4gPSBBcnJheS5mcm9tKHRyYW5zYWN0aW9uKS5tYXAodHggPT4gcHJlcGFyZVR4bih0eCkpO1xuXHRcdGVsc2Vcblx0XHRcdHR4biA9IHByZXBhcmVUeG4odHJhbnNhY3Rpb24pO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHRoaXMuY3VycmVudFNpZ250eFBvcHVwID0gb3BlblBvcHVwKHRoaXMudXJsICsgXCIvc2lnbnR4Lmh0bWxcIik7XG5cblx0XHRcdGF3YWl0IHRoaXMud2FpdEZvcldpbmRvd1RvTG9hZCh0aGlzLmN1cnJlbnRTaWdudHhQb3B1cCk7XG5cblx0XHRcdC8vIFNlbmQgdHJhbnNhY3Rpb24gaW5mb1xuXHRcdFx0Y29uc3QgcmVzID0gYXdhaXQgdGhpcy5icmlkZ2Uuc2VuZE1lc3NhZ2UoXG5cdFx0XHRcdHRoaXMuY3VycmVudFNpZ250eFBvcHVwLCB7XG5cdFx0XHRcdFx0bWV0aG9kOiBcInRyYW5zYWN0aW9uXCIsXG5cdFx0XHRcdFx0cGFyYW1zOiB7IHR4biwgc2V0dGluZ3M6IHsgZGlzYWJsZUxlZGdlck5hbm86IHRoaXMuZGlzYWJsZUxlZGdlck5hbm8gfSwgb3B0aW9uczogc2lnbk9wdGlvbnMgfSxcblx0XHRcdFx0fSxcblx0XHRcdFx0dGhpcy51cmwsIHRoaXMub3B0aW9uc1xuXHRcdFx0KTtcblxuXHRcdFx0dGhpcy5jbG9zZVdpbmRvdyh0aGlzLmN1cnJlbnRTaWdudHhQb3B1cCk7XG5cdFx0XHR0aGlzLmN1cnJlbnRTaWdudHhQb3B1cCA9IG51bGw7XG5cblx0XHRcdGlmIChyZXMuc3RhdHVzID09PSBcImVycm9yXCIpXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihyZXMubWVzc2FnZSk7XG5cblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHJlcy5kYXRhKSkge1xuXHRcdFx0XHRjb25zdCByZXN1bHQgPSBbXTtcblx0XHRcdFx0Zm9yIChjb25zdCB0IG9mIHJlcy5kYXRhKSB7XG5cdFx0XHRcdFx0dC5ibG9iID0gbmV3IFVpbnQ4QXJyYXkoQnVmZmVyLmZyb20odC5ibG9iLCBcImhleFwiKSk7XG5cdFx0XHRcdFx0cmVzdWx0LnB1c2godCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdH1cblxuXHRcdFx0cmVzLmRhdGEuYmxvYiA9IG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKHJlcy5kYXRhLmJsb2IsIFwiaGV4XCIpKTtcblxuXHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xuXHRcdH1cblx0XHRjYXRjaCAoZXJyKSB7XG5cdFx0XHR0aGlzLmNsb3NlV2luZG93KHRoaXMuY3VycmVudFNpZ250eFBvcHVwKTtcblx0XHRcdHRoaXMuY3VycmVudFNpZ250eFBvcHVwID0gbnVsbDtcblx0XHRcdHRocm93IGVycjtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQGFzeW5jXG5cdCAqIEBhY2Nlc3MgcHVibGljXG5cdCAqIEBkZXNjcmlwdGlvbiBPcGVuIGEgbmV3IHdpbmRvdyB0byBzaWduIGEgdGVhbCBwcm9ncmFtLlxuXHQgKiBAcGFyYW0ge1VpbnQ4QXJyYXl8QmFzZTY0fSBsb2dpYyBMb2dpY1NpZyBwcm9ncmFtXG5cdCAqIEBwYXJhbSB7QWRkcmVzc30gYWRkcmVzcyBTaWduZXIgQWRkcmVzc1xuXHQgKiBAcmV0dXJucyB7VWludDhBcnJheX0gUmV0dXJucyBsb2dpY3NpZyBibG9iXG5cdCAqL1xuXHRhc3luYyBzaWduTG9naWNTaWcobG9naWMsIGFkZHJlc3MpIHtcblxuXHRcdGlmICh0aGlzLmN1cnJlbnRTaWduTG9naWNTaWdQb3B1cCkge1xuXHRcdFx0aWYgKHRoaXMuY3VycmVudFNpZ25Mb2dpY1NpZ1BvcHVwLmNsb3NlZCkge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRTaWduTG9naWNTaWdQb3B1cCA9IG51bGw7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0dGhpcy5mb2N1c1dpbmRvdyh0aGlzLmN1cnJlbnRTaWduTG9naWNTaWdQb3B1cCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdHRoaXMuY3VycmVudFNpZ25Mb2dpY1NpZ1BvcHVwID0gb3BlblBvcHVwKHRoaXMudXJsICsgXCIvbG9naWNzaWd0eC5odG1sXCIpO1xuXHRcdFx0YXdhaXQgdGhpcy53YWl0Rm9yV2luZG93VG9Mb2FkKHRoaXMuY3VycmVudFNpZ25Mb2dpY1NpZ1BvcHVwKTtcblxuXHRcdFx0Ly8gU2VuZCBwcm9ncmFtXG5cdFx0XHRsZXQgbG9naWNJbkJhc2U2NCA9IGxvZ2ljO1xuXHRcdFx0aWYgKGxvZ2ljLmNvbnN0cnVjdG9yID09PSBVaW50OEFycmF5KVxuXHRcdFx0XHRsb2dpY0luQmFzZTY0ID0gQnVmZmVyLmZyb20obG9naWMpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuXHRcdFx0Y29uc3QgcmVzID0gYXdhaXQgdGhpcy5icmlkZ2Uuc2VuZE1lc3NhZ2UoXG5cdFx0XHRcdHRoaXMuY3VycmVudFNpZ25Mb2dpY1NpZ1BvcHVwLFxuXHRcdFx0XHR7IG1ldGhvZDogXCJsb2dpY3NpZ1wiLCBwYXJhbXM6IHsgbG9naWM6IGxvZ2ljSW5CYXNlNjQsIGFkZHJlc3MgfSB9LFxuXHRcdFx0XHR0aGlzLnVybCwgdGhpcy5vcHRpb25zXG5cdFx0XHQpO1xuXG5cdFx0XHR0aGlzLmNsb3NlV2luZG93KHRoaXMuY3VycmVudFNpZ25Mb2dpY1NpZ1BvcHVwKTtcblx0XHRcdHRoaXMuY3VycmVudFNpZ25Mb2dpY1NpZ1BvcHVwID0gbnVsbDtcblxuXHRcdFx0aWYgKHJlcy5zdGF0dXMgPT09IFwiZXJyb3JcIilcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKHJlcy5tZXNzYWdlKTtcblxuXHRcdFx0cmV0dXJuIG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKHJlcy5kYXRhLnNpZ25lZFRlYWwsIFwiYmFzZTY0XCIpKTtcblx0XHR9XG5cdFx0Y2F0Y2ggKGVycikge1xuXHRcdFx0dGhpcy5jbG9zZVdpbmRvdyh0aGlzLmN1cnJlbnRTaWduTG9naWNTaWdQb3B1cCk7XG5cdFx0XHR0aGlzLmN1cnJlbnRTaWduTG9naWNTaWdQb3B1cCA9IG51bGw7XG5cdFx0XHR0aHJvdyBlcnI7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEBhc3luY1xuXHQgKiBAYWNjZXNzIHB1YmxpY1xuXHQgKiBAZGVzY3JpcHRpb24gT3BlbiBhIG5ldyB3aW5kb3cgdG8gc2lnbiBkYXRhIHRvIHZlcmlmeSBpbiBhIHRlYWwgcHJvZ3JhbS5cblx0ICogQHBhcmFtIHtVaW50OEFycmF5fEJhc2U2NH0gZGF0YSBEYXRhIHRvIHNpZ25cblx0ICogQHBhcmFtIHtBZGRyZXNzfSBjb250cmFjdEFkZHJlc3MgQWRkcmVzcyBvZiB0aGUgY29udHJhY3QgdGhhdCB3aWxsIHZlcmlmeSB0aGUgZGF0YVxuXHQgKiBAcGFyYW0ge0FkZHJlc3N9IGFkZHJlc3MgU2lnbmVyIEFkZHJlc3Ncblx0ICogQHJldHVybnMge1VpbnQ4QXJyYXl9IFJldHVybnMgZGF0YSBzaWduYXR1cmVcblx0ICovXG5cdGFzeW5jIHRlYWxTaWduKGRhdGEsIGNvbnRyYWN0QWRkcmVzcywgYWRkcmVzcykge1xuXG5cdFx0aWYgKHRoaXMuY3VycmVudFRlYWxTaWduUG9wdXApIHtcblx0XHRcdGlmICh0aGlzLmN1cnJlbnRUZWFsU2lnblBvcHVwLmNsb3NlZCkge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRUZWFsU2lnblBvcHVwID0gbnVsbDtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR0aGlzLmZvY3VzV2luZG93KHRoaXMuY3VycmVudFRlYWxTaWduUG9wdXApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRUZWFsU2lnblBvcHVwID0gb3BlblBvcHVwKHRoaXMudXJsICsgXCIvdGVhbHNpZ24uaHRtbFwiKTtcblx0XHRcdGF3YWl0IHRoaXMud2FpdEZvcldpbmRvd1RvTG9hZCh0aGlzLmN1cnJlbnRUZWFsU2lnblBvcHVwKTtcblxuXHRcdFx0Ly8gU2VuZCBwcm9ncmFtXG5cdFx0XHRsZXQgZGF0YUluQmFzZTY0ID0gZGF0YTtcblx0XHRcdGlmIChkYXRhLmNvbnN0cnVjdG9yID09PSBVaW50OEFycmF5KVxuXHRcdFx0XHRkYXRhSW5CYXNlNjQgPSBCdWZmZXIuZnJvbShkYXRhKS50b1N0cmluZyhcImJhc2U2NFwiKTtcblxuXHRcdFx0Y29uc3QgcmVzID0gYXdhaXQgdGhpcy5icmlkZ2Uuc2VuZE1lc3NhZ2UoXG5cdFx0XHRcdHRoaXMuY3VycmVudFRlYWxTaWduUG9wdXAsXG5cdFx0XHRcdHsgbWV0aG9kOiBcInRlYWxzaWduXCIsIHBhcmFtczogeyBkYXRhOiBkYXRhSW5CYXNlNjQsIGNvbnRyYWN0QWRkcmVzczogY29udHJhY3RBZGRyZXNzLCBhZGRyZXNzIH0gfSxcblx0XHRcdFx0dGhpcy51cmwsIHRoaXMub3B0aW9uc1xuXHRcdFx0KTtcblxuXHRcdFx0dGhpcy5jbG9zZVdpbmRvdyh0aGlzLmN1cnJlbnRUZWFsU2lnblBvcHVwKTtcblx0XHRcdHRoaXMuY3VycmVudFRlYWxTaWduUG9wdXAgPSBudWxsO1xuXG5cdFx0XHRpZiAocmVzLnN0YXR1cyA9PT0gXCJlcnJvclwiKVxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IocmVzLm1lc3NhZ2UpO1xuXG5cdFx0XHRyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoQnVmZmVyLmZyb20ocmVzLmRhdGEuc2lnbmF0dXJlLCBcImJhc2U2NFwiKSk7XG5cdFx0fVxuXHRcdGNhdGNoIChlcnIpIHtcblx0XHRcdHRoaXMuY2xvc2VXaW5kb3codGhpcy5jdXJyZW50VGVhbFNpZ25Qb3B1cCk7XG5cdFx0XHR0aGlzLmN1cnJlbnRUZWFsU2lnblBvcHVwID0gbnVsbDtcblx0XHRcdHRocm93IGVycjtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQGFzeW5jXG5cdCAqIEBhY2Nlc3MgcHJpdmF0ZVxuXHQgKiBAZGVzY3JpcHRpb24gV2FpdCB1bnRpbCB0aGUgd2luZG93IG9wZW5lZCBsb2Fkcy5cblx0ICogQHBhcmFtIHtXaW5kb3d9IHRhcmdldFdpbmRvdyBXaW5kb3cgb3BlbmVkIGNvbnRleHQuXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSByZXRyaWVzIFRpbWVzIHRvIHJldHJ5IGJlZm9yZSB0aHJvdyBhbiBlcnJvci5cblx0ICogQHJldHVybnMge1Byb21pc2U8dm9pZD59IFRocm93IGVycm9yIGlmIHRoZSB3aW5kb3cgZG9lcyBub3QgbG9hZC5cblx0ICovXG5cdGFzeW5jIHdhaXRGb3JXaW5kb3dUb0xvYWQodGFyZ2V0V2luZG93LCByZXRyaWVzID0gMzApIHtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHJldHJpZXM7IGkrKykge1xuXHRcdFx0YXdhaXQgc2xlZXAoMzAwKTtcblx0XHRcdGlmICghdGFyZ2V0V2luZG93KSBicmVhaztcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IHJlcyA9IGF3YWl0IGJyaWRnZS5zZW5kTWVzc2FnZSh0YXJnZXRXaW5kb3csIHsgbWV0aG9kOiBcInN0YXR1c1wiIH0sIHRoaXMudXJsKTtcblx0XHRcdFx0aWYgKHJlcy5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpXG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0Y2F0Y2ggKGVycikge1xuXHRcdFx0XHQvLyBJZ25vcmUgZXJyb3Jcblx0XHRcdH1cblx0XHR9XG5cdFx0dGhyb3cgbmV3IEVycm9yKEVycm9ycy5XSU5ET1dfTk9UX0xPQURFRCk7XG5cdH1cblxuXHQvKipcblx0ICogQGFjY2VzcyBwcml2YXRlXG5cdCAqIEBkZXNjcmlwdGlvbiBTYWZlbHkgY2xvc2UgYW4gb3BlbmVkIHdpbmRvd1xuXHQgKiBAcGFyYW0ge1dpbmRvd30gd2luZG93IFdpbmRvdyBvYmplY3Rcblx0ICogQHJldHVybnMge3ZvaWR9XG5cdCAqL1xuXHRjbG9zZVdpbmRvdyh3aW5kb3cpIHtcblx0XHRpZiAod2luZG93ICYmICF3aW5kb3cuY2xvc2VkICYmIHdpbmRvdy5jbG9zZSkge1xuXHRcdFx0d2luZG93LmNsb3NlKCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEBhY2Nlc3MgcHJpdmF0ZVxuXHQgKiBAZGVzY3JpcHRpb24gRm9jdXMgY3VycmVudCBwb3B1cFxuXHQgKiBAcGFyYW0ge1dpbmRvd30gd2luZG93IFdpbmRvdyBvYmplY3Rcblx0ICogQHJldHVybnMge3ZvaWR9XG5cdCAqIEB0aHJvd3Mge1wiV2luZG93cyBpcyBvcGVuZWRcIn1cblx0ICovXG5cdGZvY3VzV2luZG93KHdpbmRvdykge1xuXHRcdGlmICh3aW5kb3cgJiYgd2luZG93LmZvY3VzKSB7XG5cdFx0XHR3aW5kb3cuZm9jdXMoKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihFcnJvcnMuV0lORE9XX0lTX09QRU5FRCk7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKEVycm9ycy5JTlZBTElEX1dJTkRPVyk7XG5cdFx0fVxuXHR9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gTXlBbGdvQ29ubmVjdDtcbiIsImNvbnN0IE1lc3NlbmdlciA9IHJlcXVpcmUoXCJAcmFuZGxhYnMvY29tbXVuaWNhdGlvbi1icmlkZ2VcIik7XG5cbmNvbnN0IFdBTExFVF9CUklER0VfQ0hBTk5FTF9OQU1FID0gXCJ3YWxsZXQtYnJpZGdlLWNvbW11bmljYXRpb24tY2hhbm5lbFwiO1xuXG5jbGFzcyBNZXNzYWdpbmcge1xuXG5cdC8qKlxuXHQgKiBAZGVzY3JpcHRpb24gUmVxdWVzdCBvYmplY3Rcblx0ICogQHR5cGVkZWYge09iamVjdH0gUmVxdWVzdFxuXHQgKiBAcHJvcGVydHkge3N0cmluZ30gbWV0aG9kIFJlcXVlc3QgbWV0aG9kXG5cdCAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBbcGFyYW1zXSBPcHRpb25hbGx5LCByZXF1ZXN0IHBhcmFtc1xuXHQgKi9cblxuXHQvKipcblx0ICogQGRlc2NyaXB0aW9uIFJlc3BvbnNlIG9iamVjdFxuXHQgKiBAdHlwZWRlZiB7T2JqZWN0fSBSZXNwb25zZVxuXHQgKiBAcHJvcGVydHkge1wiZXJyb3JcInxcInN1Y2Nlc3NcIn0gc3RhdHVzIFJlc3BvbnNlIHN0YXR1c1xuXHQgKiBAcHJvcGVydHkge3N0cmluZ30gbWVzc2FnZSBSZXNwb25zZSBtZXNzYWdlXG5cdCAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBbZGF0YV0gT3B0aW9uYWxseSwgaXMgdGhlIHJlcXVlc3Qgd2FzIGEgc3VjY2VzcyBhbmQgc2VudCBkYXRhXG5cdCAqL1xuXG5cblx0LyoqXG5cdCAqIEBkZXNjcmlwdGlvbiBDYWxsYmFjayBmdW5jdGlvbiB0byBtYW5hZ2UgbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoZSBjaGFubmVsXG4gICAgICogQGNhbGxiYWNrIG9uTWVzc2FnaW5nQ2FsbGJhY2tcbiAgICAgKiBAcGFyYW0ge1JlcXVlc3R9IHJlcXVlc3QgUmVxdWVzdCByZWNlaXZlZCBmcm9tIGFub3RoZXIgd2luZG93XG4gICAgICogQHBhcmFtIHtzZW5kUmVzcG9uc2V9IGNiIFJlc3BvbnNlIGNhbGxiYWNrXG5cdCAqIEByZXR1cm5zIHt2b2lkfVxuICAgICAqL1xuXG5cdC8qKlxuICAgICAqIEBjb25zdHJ1Y3RvciBNZXNzYWdpbmcgY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge29uTWVzc2FnaW5nQ2FsbGJhY2t9IFtsaXN0ZW5lckNhbGxiYWNrXVxuICAgICAqIEBkZXNjcmlwdGlvbiBDcmVhdGUgYW4gYWJzdHJhY3Rpb24gb2YgTWVzc2VuZ2VyIGNsYXNzXG4gICAgICovXG5cblx0Y29uc3RydWN0b3IobGlzdGVuZXJDYWxsYmFjaykge1xuXHRcdGNvbnN0IHRoYXQgPSB0aGlzO1xuXG5cdFx0LyoqXG5cdFx0ICogQGFjY2VzcyBwdWJsaWNcblx0XHQgKiBAZGVzY3JpcHRpb24gU2VuZCBtZXNzYWdlIG9wdGlvbnNcblx0XHQgKiBAdHlwZSB7aW1wb3J0KFwiYnJpZGdlLWNvbW11bmljYXRpb25cIikuc2VuZE1lc3NhZ2VPcHRpb25zfVxuXHRcdCAqL1xuXHRcdHRoaXMub3B0aW9ucyA9IHsgd2FpdEZvclJlcGx5OiB0cnVlLCB0aW1lb3V0OiAyNTAgfTtcblxuXHRcdC8qKlxuXHRcdCAqIEBhY2Nlc3MgcHJpdmF0ZVxuXHRcdCAqL1xuXHRcdHRoaXMubGlzdGVuZXJDYWxsYmFjayA9IGxpc3RlbmVyQ2FsbGJhY2s7XG5cblx0XHQvKipcblx0XHQgKiBAYWNjZXNzIHByaXZhdGVcblx0XHQgKiBAdHlwZSB7TWVzc2VuZ2VyfVxuXHRcdCAqL1xuXHRcdHRoaXMuYnJpZGdlID0gbmV3IE1lc3NlbmdlcihXQUxMRVRfQlJJREdFX0NIQU5ORUxfTkFNRSwgZnVuY3Rpb24ocmVxLCBzb3VyY2UsIGNiLCBicmlkZ2UpIHtcblx0XHRcdGlmICh0aGF0Lmxpc3RlbmVyQ2FsbGJhY2spXG5cdFx0XHRcdHRoYXQubGlzdGVuZXJDYWxsYmFjayhyZXEsIGNiKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBAYWNjZXNzIHB1YmxpY1xuICAgICAqIEBkZXNjcmlwdGlvbiBTZW5kIG1lc3NhZ2UgdG8gYSB0YXJnZXQgd2luZG93XG4gICAgICogQHBhcmFtIHtXaW5kb3d9IHdpbmRvdyBUYXJnZXQgd2luZG93XG4gICAgICogQHBhcmFtIHtSZXF1ZXN0fSByZXF1ZXN0IFJlcXVlc3RcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb3JpZ2luIFRhcmdldCBvcmlnaW5cblx0ICogQHBhcmFtIHtpbXBvcnQoXCJicmlkZ2UtY29tbXVuaWNhdGlvblwiKS5zZW5kTWVzc2FnZU9wdGlvbnN9IFtvcHRpb25zXSBPdmVycmlkZSBkZWZhdWx0IG1lc3NhZ2Ugb3B0aW9uc1xuXHQgKiBAcmV0dXJucyB7UHJvbWlzZTxSZXNwb25zZT59IFJlc3BvbnNlIG9mIHRoZSB0YXJnZXQgd2luZG93XG4gICAgICovXG5cblx0c2VuZE1lc3NhZ2Uod2luZG93LCByZXF1ZXN0LCBvcmlnaW4sIG9wdGlvbnMpIHtcblx0XHRyZXR1cm4gdGhpcy5icmlkZ2Uuc2VuZE1lc3NhZ2Uod2luZG93LCByZXF1ZXN0LCBvcmlnaW4sIG9wdGlvbnMgPyBvcHRpb25zIDogdGhpcy5vcHRpb25zKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBAYWNjZXNzIHB1YmxpY1xuXHQgKiBAZGVzY3JpcHRpb24gU2V0IG5ldyBsaXN0ZW5lclxuXHQgKiBAcGFyYW0ge29uTWVzc2FnaW5nQ2FsbGJhY2t9IFtsaXN0ZW5lckNhbGxiYWNrXSBTZXQgYSBuZXcgbGlzdGVuZXIgb3Igb3ZlcnJpZGUgYWN0dWFsIGxpc3RlbmVyXG5cdCAqIEByZXR1cm5zIHt2b2lkfVxuXHQgKi9cblx0c2V0TmV3TGlzdGVuZXIobGlzdGVuZXJDYWxsYmFjaykge1xuXHRcdHRoaXMubGlzdGVuZXJDYWxsYmFjayA9IGxpc3RlbmVyQ2FsbGJhY2s7XG5cdH1cblxuXHQvKipcblx0ICogQGFjY2VzcyBwdWJsaWNcblx0ICogQGRlc2NyaXB0aW9uIENsb3NlIGJyaWRnZVxuXHQgKiBAcmV0dXJucyB7dm9pZH1cblx0ICovXG5cdGNsb3NlKCkge1xuXHRcdHRoaXMuYnJpZGdlLmNsb3NlKCk7XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBNZXNzYWdpbmc7XG4iLCJjb25zdCB7IFdJTkRPV19OT1RfT1BFTkVEIH0gPSByZXF1aXJlKFwiLi4vdXRpbHMvZXJyb3JzXCIpO1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvbiBQb3B1cCBjb25maWd1cmF0aW9uXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBQb3B1cE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbbmFtZV1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbd2lkdGhdXG4gKiBAcHJvcGVydHkge251bWJlcn0gW2hlaWdodF1cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbdG9wXVxuICogQHByb3BlcnR5IHtudW1iZXJ9IFtsZWZ0XVxuICogQHByb3BlcnR5IHswfDF9IFtzdGF0dXNdXG4gKiBAcHJvcGVydHkgezB8MX0gW3Jlc2l6YWJsZV1cbiAqIEBwcm9wZXJ0eSB7MHwxfSBbdG9vbGJhcl1cbiAqIEBwcm9wZXJ0eSB7MHwxfSBbbWVudWJhcl1cbiAqIEBwcm9wZXJ0eSB7MHwxfSBbc2Nyb2xsYmFyc11cbiAqL1xuXG4vKipcbiAqIEB0eXBlIHtQb3B1cE9wdGlvbnN9XG4gKi9cbmNvbnN0IGRlZmF1bHRPcHRpb25zID0ge1xuXHR3aWR0aDogNDAwLFxuXHRoZWlnaHQ6IDYwMCxcbn07XG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIE9wZW4gYSBuZXcgYnJvd3NlciB3aW5kb3dcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIEBwYXJhbSB7UG9wdXBPcHRpb25zfSBvcHRpb25zXG4gKiBAcmV0dXJucyB7V2luZG93fVxuICogQGZpbGUgT3BlbiBuZXcgcG9wdXBcbiAqIEBhdXRob3IgVGhlIGtyYWtlbi5qcyB0ZWFtXG4gKiBAY29weXJpZ2h0IFRoaXMgZmlsZSBpcyBwYXJ0IG9mIHRoZSBwcm9qZWN0IEJlbHRlckpTIHdoaWNoIGlzIHJlbGVhc2VkIHVuZGVyIEFwYWNoZS0yLjAgTGljZW5zZS5cbiAqIEdvIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9rcmFrZW5qcy9iZWx0ZXIgZm9yIGZ1bGwgbGljZW5zZSBkZXRhaWxzLlxuICovXG5cbmZ1bmN0aW9uIG9wZW5Qb3B1cCh1cmwsIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucykge1xuXG5cdGxldCB7IG5hbWUgPSAnJywgd2lkdGgsIGhlaWdodCwgdG9wID0gMCwgbGVmdCA9IDAgfSA9IG9wdGlvbnM7XG5cblx0aWYgKHdpZHRoKSB7XG5cdFx0aWYgKHdpbmRvdy5vdXRlcldpZHRoKSB7XG5cdFx0XHRsZWZ0ID0gTWF0aC5yb3VuZCgod2luZG93Lm91dGVyV2lkdGggLSB3aWR0aCkgLyAyKSArIHdpbmRvdy5zY3JlZW5YO1xuXHRcdH1cblx0XHRlbHNlIGlmICh3aW5kb3cuc2NyZWVuLndpZHRoKSB7XG5cdFx0XHRsZWZ0ID0gTWF0aC5yb3VuZCgod2luZG93LnNjcmVlbi53aWR0aCAtIHdpZHRoKSAvIDIpO1xuXHRcdH1cblx0fVxuXG5cdGlmIChoZWlnaHQpIHtcblx0XHRpZiAod2luZG93Lm91dGVySGVpZ2h0KSB7XG5cdFx0XHR0b3AgPSBNYXRoLnJvdW5kKCh3aW5kb3cub3V0ZXJIZWlnaHQgLSBoZWlnaHQpIC8gMikgKyB3aW5kb3cuc2NyZWVuWTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAod2luZG93LnNjcmVlbi5oZWlnaHQpIHtcblx0XHRcdHRvcCA9IE1hdGgucm91bmQoKHdpbmRvdy5zY3JlZW4uaGVpZ2h0IC0gaGVpZ2h0KSAvIDIpO1xuXHRcdH1cblx0fVxuXG5cdGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcblx0XHRvcHRpb25zID0ge1xuXHRcdFx0dG9wLFxuXHRcdFx0bGVmdCxcblx0XHRcdHdpZHRoLFxuXHRcdFx0aGVpZ2h0LFxuXHRcdFx0c3RhdHVzOiAxLFxuXHRcdFx0dG9vbGJhcjogMCxcblx0XHRcdG1lbnViYXI6IDAsXG5cdFx0XHRyZXNpemFibGU6IDEsXG5cdFx0XHRzY3JvbGxiYXJzOiAxLFxuXHRcdH07XG5cdH1cblxuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgYXJyYXktY2FsbGJhY2stcmV0dXJuXG5cdGNvbnN0IHBhcmFtcyA9IE9iamVjdC5rZXlzKG9wdGlvbnMpLm1hcCgoa2V5KSA9PiB7XG5cdFx0Y29uc3QgcGFyYW0gPSBvcHRpb25zW2tleV07XG5cdFx0aWYgKHBhcmFtICE9PSBudWxsICYmIHBhcmFtICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHBhcmFtLnRvU3RyaW5nID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRyZXR1cm4gYCR7a2V5fT0ke3BhcmFtLnRvU3RyaW5nKCl9YDtcblx0XHR9XG5cdH0pLmZpbHRlcihCb29sZWFuKS5qb2luKCcsJyk7XG5cblx0bGV0IHdpbjtcblxuXHR0cnkge1xuXHRcdHdpbiA9IHdpbmRvdy5vcGVuKHVybCwgbmFtZSwgcGFyYW1zKTtcblx0fVxuXHRjYXRjaCAoZXJyKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKGAke1dJTkRPV19OT1RfT1BFTkVEfSAtICR7ZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlfWApO1xuXHR9XG5cblx0aWYgKCF3aW4gfHwgd2luZG93LmNsb3NlZCkge1xuXHRcdHRocm93IG5ldyBFcnJvcihgJHtXSU5ET1dfTk9UX09QRU5FRH0gLSBibG9ja2VkYCk7XG5cdH1cblxuXHRyZXR1cm4gd2luO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblx0b3BlblBvcHVwLFxufTtcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuXHRXSU5ET1dfTk9UX0xPQURFRDogXCJXaW5kb3cgbm90IGxvYWRlZFwiLFxuXHRXSU5ET1dfSVNfT1BFTkVEOiBcIldpbmRvd3MgaXMgb3BlbmVkXCIsXG5cdFdJTkRPV19OT1RfT1BFTkVEOiBcIkNhbiBub3Qgb3BlbiBwb3B1cCB3aW5kb3dcIixcblx0SU5WQUxJRF9XSU5ET1c6IFwiSW52YWxpZCB3aW5kb3dcIixcbn07XG4iLCJcbmZ1bmN0aW9uIHNsZWVwKG1zZWMgPSAyMDApIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtc2VjKSk7XG59XG5cbi8qKlxuICogQHR5cGVkZWYge2ltcG9ydChcIi4uL21haW5cIikuVHJhbnNhY3Rpb259IFRyYW5zYWN0aW9uXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7aW1wb3J0KFwiLi4vbWFpblwiKS5FbmNvZGVkVHJhbnNhY3Rpb259IEVuY29kZWRUcmFuc2FjdGlvblxuICovXG5cbi8qKlxuICogQGRlc2NyaXB0aW9uIFByZXBhcmF0ZSB0cmFuc2FjdGlvbnMgYmVmb3JlIHNlbmQgaXQgdG8gdGhlIGJyaWRnZS5cbiAqIFRoaXMgbWV0aG9kIGNoYW5nZXMgYWxsIEFycmF5QnVmZmVyIHRvIGJhc2U2NC5cbiAqIEBwYXJhbSB7VHJhbnNhY3Rpb258RW5jb2RlZFRyYW5zYWN0aW9ufSB0cmFuc2FjdGlvbiBUcmFuc2FjdGlvbiBwcm92aWRlZCBieSB0aGUgdXNlclxuICogQHJldHVybnMge2FueX0gUmV0dXJuIHRoZSBzYW1lIGlucHV0XG4gKi9cbmZ1bmN0aW9uIHByZXBhcmVUeG4odHJhbnNhY3Rpb24pIHtcblxuXHRpZiAodHJhbnNhY3Rpb24uY29uc3RydWN0b3IgPT09IFVpbnQ4QXJyYXkpXG5cdFx0cmV0dXJuIEJ1ZmZlci5mcm9tKHRyYW5zYWN0aW9uKS50b1N0cmluZyhcImJhc2U2NFwiKTtcblx0ZWxzZSBpZiAodHlwZW9mIHRyYW5zYWN0aW9uID09PSBcInN0cmluZ1wiKVxuXHRcdHJldHVybiB0cmFuc2FjdGlvbjtcblxuXHRjb25zdCB0eG4gPSBPYmplY3QuYXNzaWduKHt9LCB0cmFuc2FjdGlvbik7XG5cblx0aWYgKHR4bi5ub3RlICYmIHR4bi5ub3RlLmNvbnN0cnVjdG9yID09PSBVaW50OEFycmF5KVxuXHRcdHR4bi5ub3RlID0gQnVmZmVyLmZyb20odHhuLm5vdGUpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuXG5cdGlmICh0eG4uYXNzZXRNZXRhZGF0YUhhc2ggJiYgdHhuLmFzc2V0TWV0YWRhdGFIYXNoLmNvbnN0cnVjdG9yID09PSBVaW50OEFycmF5KVxuXHRcdHR4bi5hc3NldE1ldGFkYXRhSGFzaCA9IEJ1ZmZlci5mcm9tKHR4bi5hc3NldE1ldGFkYXRhSGFzaCkudG9TdHJpbmcoXCJiYXNlNjRcIik7XG5cblx0aWYgKHR4bi5ncm91cCAmJiB0eG4uZ3JvdXAuY29uc3RydWN0b3IgPT09IFVpbnQ4QXJyYXkpXG5cdFx0dHhuLmdyb3VwID0gQnVmZmVyLmZyb20odHhuLmdyb3VwKS50b1N0cmluZyhcImJhc2U2NFwiKTtcblxuXHRpZiAodHhuLnR5cGUgPT09IFwiYXBwbFwiICYmIHR4bi5hcHBBcHByb3ZhbFByb2dyYW0gJiYgdHhuLmFwcEFwcHJvdmFsUHJvZ3JhbS5jb25zdHJ1Y3RvciA9PT0gVWludDhBcnJheSlcblx0XHR0eG4uYXBwQXBwcm92YWxQcm9ncmFtID0gQnVmZmVyLmZyb20odHhuLmFwcEFwcHJvdmFsUHJvZ3JhbSkudG9TdHJpbmcoXCJiYXNlNjRcIik7XG5cblx0aWYgKHR4bi50eXBlID09PSBcImFwcGxcIiAmJiB0eG4uYXBwQ2xlYXJQcm9ncmFtICYmIHR4bi5hcHBDbGVhclByb2dyYW0uY29uc3RydWN0b3IgPT09IFVpbnQ4QXJyYXkpXG5cdFx0dHhuLmFwcENsZWFyUHJvZ3JhbSA9IEJ1ZmZlci5mcm9tKHR4bi5hcHBDbGVhclByb2dyYW0pLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuXG5cdGlmICh0eG4udHlwZSA9PT0gXCJhcHBsXCIgJiYgdHhuLmFwcEFyZ3MgJiYgdHhuLmFwcEFyZ3MubGVuZ3RoID4gMClcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHR4bi5hcHBBcmdzLmxlbmd0aDsgaSsrKVxuXHRcdFx0aWYgKHR4bi5hcHBBcmdzW2ldLmNvbnN0cnVjdG9yID09PSBVaW50OEFycmF5KVxuXHRcdFx0XHR0eG4uYXBwQXJnc1tpXSA9IEJ1ZmZlci5mcm9tKHR4bi5hcHBBcmdzW2ldKS50b1N0cmluZyhcImJhc2U2NFwiKTtcblxuXHRyZXR1cm4gdHhuO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblx0c2xlZXAsXG5cdHByZXBhcmVUeG4sXG59O1xuIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJjb25zdHJ1Y3RvciIsImNoYW5uZWxOYW1lIiwib25NZXNzYWdlQ2FsbGJhY2siLCJ0aGlzIiwib25NZXNzYWdlIiwiX2luc3RhbGxMaXN0ZW5lciIsIl9yZXF1ZXN0cyIsIk1hcCIsIl9uZXh0SWQiLCJfZGVmYXVsdFRpbWVvdXQiLCJ0aGF0IiwiX2xpc3RlbmVyIiwiZXZlbnQiLCJkYXRhIiwianNvbiIsIkpTT04iLCJwYXJzZSIsImNoYW5uZWwiLCJtZXNzYWdlIiwiZXJyIiwicmVwbHlJZCIsInJlcSIsImdldCIsImNsZWFyVGltZW91dCIsInRpbWVvdXQiLCJkZWxldGUiLCJyZXNvbHZlIiwiaWQiLCJvcmlnaW4iLCJyZXBseU1lc3NhZ2UiLCJyZXF1ZXN0Iiwic291cmNlIiwicG9zdE1lc3NhZ2UiLCJzdHJpbmdpZnkiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwic2VuZE1lc3NhZ2UiLCJ0YXJnZXRXaW5kb3ciLCJvcHRpb25zIiwiZ2V0TmV4dElkIiwid2FpdEZvclJlcGx5IiwiUHJvbWlzZSIsInJlamVjdCIsInNldFRpbWVvdXQiLCJFcnJvciIsInNldCIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9wZW5Qb3B1cCIsInNsZWVwIiwicHJlcGFyZVR4biIsIkVycm9ycyIsIk1lc3NhZ2luZyIsImJyaWRnZSIsInVybCIsImJyaWRnZVVybCIsImVuZHNXaXRoIiwic2xpY2UiLCJjdXJyZW50Q29ubmVjdFBvcHVwIiwiY3VycmVudFNpZ250eFBvcHVwIiwiY3VycmVudFNpZ25Mb2dpY1NpZ1BvcHVwIiwiY3VycmVudFRlYWxTaWduUG9wdXAiLCJkaXNhYmxlTGVkZ2VyTmFubyIsImFzeW5jIiwic2V0dGluZ3MiLCJzaG91bGRTZWxlY3RPbmVBY2NvdW50Iiwib3Blbk1hbmFnZXIiLCJjbG9zZWQiLCJmb2N1c1dpbmRvdyIsIndhaXRGb3JXaW5kb3dUb0xvYWQiLCJyZXMiLCJtZXRob2QiLCJwYXJhbXMiLCJPYmplY3QiLCJhc3NpZ24iLCJjbG9zZVdpbmRvdyIsInN0YXR1cyIsImFjY291bnRzIiwidHJhbnNhY3Rpb24iLCJzaWduT3B0aW9ucyIsInR4biIsIkFycmF5IiwiaXNBcnJheSIsImZyb20iLCJtYXAiLCJ0eCIsInJlc3VsdCIsInQiLCJibG9iIiwiVWludDhBcnJheSIsIkJ1ZmZlciIsInB1c2giLCJsb2dpYyIsImFkZHJlc3MiLCJsb2dpY0luQmFzZTY0IiwidG9TdHJpbmciLCJzaWduZWRUZWFsIiwiY29udHJhY3RBZGRyZXNzIiwiZGF0YUluQmFzZTY0Iiwic2lnbmF0dXJlIiwicmV0cmllcyIsImkiLCJXSU5ET1dfTk9UX0xPQURFRCIsImZvY3VzIiwiV0lORE9XX0lTX09QRU5FRCIsIklOVkFMSURfV0lORE9XIiwiTWVzc2VuZ2VyIiwibGlzdGVuZXJDYWxsYmFjayIsImNiIiwic2V0TmV3TGlzdGVuZXIiLCJXSU5ET1dfTk9UX09QRU5FRCIsImRlZmF1bHRPcHRpb25zIiwid2lkdGgiLCJoZWlnaHQiLCJuYW1lIiwidG9wIiwibGVmdCIsIm91dGVyV2lkdGgiLCJNYXRoIiwicm91bmQiLCJzY3JlZW5YIiwic2NyZWVuIiwib3V0ZXJIZWlnaHQiLCJzY3JlZW5ZIiwidG9vbGJhciIsIm1lbnViYXIiLCJyZXNpemFibGUiLCJzY3JvbGxiYXJzIiwia2V5cyIsImtleSIsInBhcmFtIiwiZmlsdGVyIiwiQm9vbGVhbiIsImpvaW4iLCJ3aW4iLCJvcGVuIiwic3RhY2siLCJtc2VjIiwibm90ZSIsImFzc2V0TWV0YWRhdGFIYXNoIiwiZ3JvdXAiLCJ0eXBlIiwiYXBwQXBwcm92YWxQcm9ncmFtIiwiYXBwQ2xlYXJQcm9ncmFtIiwiYXBwQXJncyIsImxlbmd0aCJdLCJzb3VyY2VSb290IjoiIn0=